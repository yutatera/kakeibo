<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <title>家計簿</title>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
  <style type="text/css">
    .sidebar {
      top:70px;
      position: -webkit-sticky;
      position: sticky;
    }
    body { padding-top: 70px; }
  </style>
</head>

<body>
  <!--ナビゲーションウィンドウ-->
  <nav class="navbar navbar-expand navbar-dark bg-dark fixed-top">
    <div class="navbar-brand">家計簿</div>
    <div class="navbar-nav">
      <a class="nav-item nav-link" href="index">推移</a>
      <a class="nav-item nav-link" href="future">予測</a>
      <a class="nav-item nav-link active" href="month">月毎・年毎</a>
    </div>
  </nav>

  <div class="container-fluid">
  <div class="row">
    <!--サイドバー-->
    <div class="col-2">
    <div class="sidebar">
    <ul class="nav flex-column">
      <li class="nav-item">
        <span data-feather="settings"></span>
        <span class="navbar-text">設定</span>
      </li>
      <li><input type="radio" name="radio" id="年" value="年">年</li>
      <ul class="list-unstyled ml-2">
        <li><select name="year" id="year"></select></li>
      </ul>
      <li><input type="radio" name="radio" id="月" value="月"  checked="checked">月</li>
      <ul class="list-unstyled ml-2">
        <li><select name="month" id="month"></select></li>
      </ul>
    </ul>
    </div>
    </div>


    <!--メイン-->
    <main role="main" class="col-md-7">
      <h1>概要</h1>
      <div id="tbl_summary"></div>

      <h1>収入</h1>
      <canvas id="shunyu" height="30%" width="100%"></canvas>
      <div id="tbl_shunyu"></div>

      <h1>支出</h1>
      <canvas id="sishutu" height="30%" width="100%"></canvas>
      <div id="tbl_sishutu"></div>
    </main>
  </div>

  <!-- ----------------- -->
  <!-- ここからjavascript -->
  <!-- ----------------- -->
  <script>
    url = location.href
    dataMonthAve_sample = [{"200104": {"収入": {"収入": 683136}, "支出": {"支出": 304843}, "収支": {"収支": 378293}, "収入項目": {"給与A": 517373, "給与B": 165763}, "支出小項目": {"電気": 5679, "ガス": 7946, "水道": 4863, "通信": 6511, "住居": 110667, "保険": 10542, "医療": 8458, "食料品": 50628, "日用雑貨": 11624, "交通": 14519, "娯楽": 21897, "交際": 38669, "その他": 12840}, "支出大項目": {"光熱水": 18488, "通信": 6511, "住居": 110667, "医療・保険": 19000, "食料品": 50628, "日用雑貨": 11624, "交通": 14519, "娯楽": 21897, "交際": 38669}, "資産": {"資産": 11378293}}, "200105": {"収入": {"収入": 730751}, "支出": {"支出": 332489}, "収支": {"収支": 398262}, "収入項目": {"給与A": 548867, "給与B": 181884}, "支出小項目": {"電気": 7069, "ガス": 6435, "水道": 6062, "通信": 7490, "住居": 111824, "保険": 10900, "医療": 9673, "食料品": 55645, "日用雑貨": 11303, "交通": 12194, "娯楽": 33296, "交際": 41777, "その他": 18821}, "支出大項目": {"光熱水": 19566, "通信": 7490, "住居": 111824, "医療・保険": 20573, "食料品": 55645, "日用雑貨": 11303, "交通": 12194, "娯楽": 33296, "交際": 41777}, "資産": {"資産": 11776555}}, "200106": {"収入": {"収入": 727404}, "支出": {"支出": 321045}, "収支": {"収支": 406359}, "収入項目": {"給与A": 531616, "給与B": 195788}, "支出小項目": {"電気": 7145, "ガス": 5538, "水道": 7010, "通信": 5860, "住居": 109965, "保険": 10887, "医療": 5776, "食料品": 67851, "日用雑貨": 11691, "交通": 11320, "娯楽": 26677, "交際": 39517, "その他": 11808}, "支出大項目": {"光熱水": 19693, "通信": 5860, "住居": 109965, "医療・保険": 16663, "食料品": 67851, "日用雑貨": 11691, "交通": 11320, "娯楽": 26677, "交際": 39517}, "資産": {"資産": 12182914}}, "200107": {"収入": {"収入": 687472}, "支出": {"支出": 325690}, "収支": {"収支": 361782}, "収入項目": {"給与A": 584865, "給与B": 102607}, "支出小項目": {"電気": 6630, "ガス": 7630, "水道": 6422, "通信": 6267, "住居": 110112, "保険": 10036, "医療": 5290, "食料品": 54684, "日用雑貨": 14636, "交通": 14525, "娯楽": 29074, "交際": 46065, "その他": 14319}, "支出大項目": {"光熱水": 20682, "通信": 6267, "住居": 110112, "医療・保険": 15326, "食料品": 54684, "日用雑貨": 14636, "交通": 14525, "娯楽": 29074, "交際": 46065}, "資産": {"資産": 12544696}}, "200108": {"収入": {"収入": 746171}, "支出": {"支出": 313601}, "収支": {"収支": 432570}, "収入項目": {"給与A": 583619, "給与B": 162552}, "支出小項目": {"電気": 7523, "ガス": 4494, "水道": 6084, "通信": 6168, "住居": 105182, "保険": 10481, "医療": 7315, "食料品": 56623, "日用雑貨": 14837, "交通": 16899, "娯楽": 24994, "交際": 39746, "その他": 13255}, "支出大項目": {"光熱水": 18101, "通信": 6168, "住居": 105182, "医療・保険": 17796, "食料品": 56623, "日用雑貨": 14837, "交通": 16899, "娯楽": 24994, "交際": 39746}, "資産": {"資産": 12977266}}, "200109": {"収入": {"収入": 640840}, "支出": {"支出": 333915}, "収支": {"収支": 306925}, "収入項目": {"給与A": 512560, "給与B": 128280}, "支出小項目": {"電気": 5766, "ガス": 7524, "水道": 6138, "通信": 5372, "住居": 114232, "保険": 10304, "医療": 7881, "食料品": 66083, "日用雑貨": 18554, "交通": 12651, "娯楽": 26179, "交際": 36476, "その他": 16755}, "支出大項目": {"光熱水": 19428, "通信": 5372, "住居": 114232, "医療・保険": 18185, "食料品": 66083, "日用雑貨": 18554, "交通": 12651, "娯楽": 26179, "交際": 36476}, "資産": {"資産": 13284191}}, "200110": {"収入": {"収入": 654468}, "支出": {"支出": 337203}, "収支": {"収支": 317265}, "収入項目": {"給与A": 530635, "給与B": 123833}, "支出小項目": {"電気": 7015, "ガス": 4271, "水道": 5935, "通信": 6389, "住居": 111386, "保険": 10807, "医療": 7305, "食料品": 53670, "日用雑貨": 15578, "交通": 19389, "娯楽": 32245, "交際": 45085, "その他": 18128}, "支出大項目": {"光熱水": 17221, "通信": 6389, "住居": 111386, "医療・保険": 18112, "食料品": 53670, "日用雑貨": 15578, "交通": 19389, "娯楽": 32245, "交際": 45085}, "資産": {"資産": 13601456}}, "200111": {"収入": {"収入": 701337}, "支出": {"支出": 345072}, "収支": {"収支": 356265}, "収入項目": {"給与A": 537082, "給与B": 164255}, "支出小項目": {"電気": 7893, "ガス": 4889, "水道": 6930, "通信": 6505, "住居": 116862, "保険": 10447, "医療": 9020, "食料品": 67383, "日用雑貨": 16242, "交通": 18474, "娯楽": 25318, "交際": 41585, "その他": 13524}, "支出大項目": {"光熱水": 19712, "通信": 6505, "住居": 116862, "医療・保険": 19467, "食料品": 67383, "日用雑貨": 16242, "交通": 18474, "娯楽": 25318, "交際": 41585}, "資産": {"資産": 13957721}}, "200112": {"収入": {"収入": 760635}, "支出": {"支出": 321137}, "収支": {"収支": 439498}, "収入項目": {"給与A": 571464, "給与B": 189171}, "支出小項目": {"電気": 4119, "ガス": 7479, "水道": 6310, "通信": 7102, "住居": 110884, "保険": 10749, "医療": 5571, "食料品": 52866, "日用雑貨": 12102, "交通": 15741, "娯楽": 34505, "交際": 36175, "その他": 17534}, "支出大項目": {"光熱水": 17908, "通信": 7102, "住居": 110884, "医療・保険": 16320, "食料品": 52866, "日用雑貨": 12102, "交通": 15741, "娯楽": 34505, "交際": 36175}, "資産": {"資産": 14397219}}, "200201": {"収入": {"収入": 721327}, "支出": {"支出": 303929}, "収支": {"収支": 417398}, "収入項目": {"給与A": 564473, "給与B": 156854}, "支出小項目": {"電気": 5052, "ガス": 4616, "水道": 5773, "通信": 6498, "住居": 104194, "保険": 10312, "医療": 6573, "食料品": 53223, "日用雑貨": 12431, "交通": 10703, "娯楽": 29456, "交際": 40860, "その他": 14238}, "支出大項目": {"光熱水": 15441, "通信": 6498, "住居": 104194, "医療・保険": 16885, "食料品": 53223, "日用雑貨": 12431, "交通": 10703, "娯楽": 29456, "交際": 40860}, "資産": {"資産": 14814617}}, "200202": {"収入": {"収入": 704362}, "支出": {"支出": 320978}, "収支": {"収支": 383384}, "収入項目": {"給与A": 543186, "給与B": 161176}, "支出小項目": {"電気": 6433, "ガス": 5335, "水道": 7924, "通信": 4058, "住居": 108280, "保険": 10286, "医療": 7209, "食料品": 50095, "日用雑貨": 17596, "交通": 10899, "娯楽": 33923, "交際": 47588, "その他": 11352}, "支出大項目": {"光熱水": 19692, "通信": 4058, "住居": 108280, "医療・保険": 17495, "食料品": 50095, "日用雑貨": 17596, "交通": 10899, "娯楽": 33923, "交際": 47588}, "資産": {"資産": 15198001}}, "200203": {"収入": {"収入": 657362}, "支出": {"支出": 320441}, "収支": {"収支": 336921}, "収入項目": {"給与A": 534529, "給与B": 122833}, "支出小項目": {"電気": 7127, "ガス": 5778, "水道": 7128, "通信": 7025, "住居": 109411, "保険": 10116, "医療": 6389, "食料品": 56587, "日用雑貨": 14089, "交通": 10242, "娯楽": 26630, "交際": 48215, "その他": 11704}, "支出大項目": {"光熱水": 20033, "通信": 7025, "住居": 109411, "医療・保険": 16505, "食料品": 56587, "日用雑貨": 14089, "交通": 10242, "娯楽": 26630, "交際": 48215}, "資産": {"資産": 15534922}}, "200204": {"収入": {"収入": 717571}, "支出": {"支出": 319028}, "収支": {"収支": 398543}, "収入項目": {"給与A": 519776, "給与B": 197795}, "支出小項目": {"電気": 4553, "ガス": 5528, "水道": 5243, "通信": 4735, "住居": 109608, "保険": 10242, "医療": 7933, "食料品": 61226, "日用雑貨": 14144, "交通": 16943, "娯楽": 30050, "交際": 36032, "その他": 12791}, "支出大項目": {"光熱水": 15324, "通信": 4735, "住居": 109608, "医療・保険": 18175, "食料品": 61226, "日用雑貨": 14144, "交通": 16943, "娯楽": 30050, "交際": 36032}, "資産": {"資産": 15933465}}, "200205": {"収入": {"収入": 624011}, "支出": {"支出": 319341}, "収支": {"収支": 304670}, "収入項目": {"給与A": 508633, "給与B": 115378}, "支出小項目": {"電気": 5568, "ガス": 7822, "水道": 5685, "通信": 5080, "住居": 105454, "保険": 10679, "医療": 5505, "食料品": 60624, "日用雑貨": 12816, "交通": 11336, "娯楽": 31965, "交際": 37653, "その他": 19154}, "支出大項目": {"光熱水": 19075, "通信": 5080, "住居": 105454, "医療・保険": 16184, "食料品": 60624, "日用雑貨": 12816, "交通": 11336, "娯楽": 31965, "交際": 37653}, "資産": {"資産": 16238135}}, "200206": {"収入": {"収入": 773369}, "支出": {"支出": 300875}, "収支": {"収支": 472494}, "収入項目": {"給与A": 588642, "給与B": 184727}, "支出小項目": {"電気": 5396, "ガス": 5685, "水道": 6287, "通信": 4178, "住居": 102391, "保険": 10268, "医療": 7204, "食料品": 66642, "日用雑貨": 12181, "交通": 10895, "娯楽": 22905, "交際": 33899, "その他": 12944}, "支出大項目": {"光熱水": 17368, "通信": 4178, "住居": 102391, "医療・保険": 17472, "食料品": 66642, "日用雑貨": 12181, "交通": 10895, "娯楽": 22905, "交際": 33899}, "資産": {"資産": 16710629}}, "200207": {"収入": {"収入": 761045}, "支出": {"支出": 322952}, "収支": {"収支": 438093}, "収入項目": {"給与A": 578093, "給与B": 182952}, "支出小項目": {"電気": 4498, "ガス": 5629, "水道": 7143, "通信": 7780, "住居": 111053, "保険": 10157, "医療": 6075, "食料品": 59587, "日用雑貨": 17483, "交通": 13642, "娯楽": 24055, "交際": 41290, "その他": 14560}, "支出大項目": {"光熱水": 17270, "通信": 7780, "住居": 111053, "医療・保険": 16232, "食料品": 59587, "日用雑貨": 17483, "交通": 13642, "娯楽": 24055, "交際": 41290}, "資産": {"資産": 17148722}}, "200208": {"収入": {"収入": 672992}, "支出": {"支出": 304155}, "収支": {"収支": 368837}, "収入項目": {"給与A": 536410, "給与B": 136582}, "支出小項目": {"電気": 6313, "ガス": 5170, "水道": 5497, "通信": 4619, "住居": 107769, "保険": 10170, "医療": 6903, "食料品": 52208, "日用雑貨": 10165, "交通": 13180, "娯楽": 25272, "交際": 45416, "その他": 11473}, "支出大項目": {"光熱水": 16980, "通信": 4619, "住居": 107769, "医療・保険": 17073, "食料品": 52208, "日用雑貨": 10165, "交通": 13180, "娯楽": 25272, "交際": 45416}, "資産": {"資産": 17517559}}, "200209": {"収入": {"収入": 744705}, "支出": {"支出": 303453}, "収支": {"収支": 441252}, "収入項目": {"給与A": 556733, "給与B": 187972}, "支出小項目": {"電気": 5450, "ガス": 4471, "水道": 4243, "通信": 4652, "住居": 102802, "保険": 10456, "医療": 7156, "食料品": 52240, "日用雑貨": 14334, "交通": 12784, "娯楽": 21164, "交際": 45690, "その他": 18011}, "支出大項目": {"光熱水": 14164, "通信": 4652, "住居": 102802, "医療・保険": 17612, "食料品": 52240, "日用雑貨": 14334, "交通": 12784, "娯楽": 21164, "交際": 45690}, "資産": {"資産": 17958811}}, "200210": {"収入": {"収入": 667086}, "支出": {"支出": 340495}, "収支": {"収支": 326591}, "収入項目": {"給与A": 512352, "給与B": 154734}, "支出小項目": {"電気": 4872, "ガス": 6650, "水道": 7978, "通信": 4353, "住居": 113655, "保険": 10653, "医療": 7689, "食料品": 65995, "日用雑貨": 12855, "交通": 17608, "娯楽": 26368, "交際": 43156, "その他": 18663}, "支出大項目": {"光熱水": 19500, "通信": 4353, "住居": 113655, "医療・保険": 18342, "食料品": 65995, "日用雑貨": 12855, "交通": 17608, "娯楽": 26368, "交際": 43156}, "資産": {"資産": 18285402}}, "200211": {"収入": {"収入": 674945}, "支出": {"支出": 323743}, "収支": {"収支": 351202}, "収入項目": {"給与A": 503509, "給与B": 171436}, "支出小項目": {"電気": 4265, "ガス": 4815, "水道": 5275, "通信": 6984, "住居": 109417, "保険": 10043, "医療": 6900, "食料品": 53745, "日用雑貨": 19834, "交通": 14774, "娯楽": 25080, "交際": 43125, "その他": 19486}, "支出大項目": {"光熱水": 14355, "通信": 6984, "住居": 109417, "医療・保険": 16943, "食料品": 53745, "日用雑貨": 19834, "交通": 14774, "娯楽": 25080, "交際": 43125}, "資産": {"資産": 18636604}}, "200212": {"収入": {"収入": 707703}, "支出": {"支出": 321044}, "収支": {"収支": 386659}, "収入項目": {"給与A": 522599, "給与B": 185104}, "支出小項目": {"電気": 7415, "ガス": 6031, "水道": 4491, "通信": 7517, "住居": 118113, "保険": 10114, "医療": 5400, "食料品": 55835, "日用雑貨": 13095, "交通": 11688, "娯楽": 29282, "交際": 40647, "その他": 11416}, "支出大項目": {"光熱水": 17937, "通信": 7517, "住居": 118113, "医療・保険": 15514, "食料品": 55835, "日用雑貨": 13095, "交通": 11688, "娯楽": 29282, "交際": 40647}, "資産": {"資産": 19023263}}, "200301": {"収入": {"収入": 663950}, "支出": {"支出": 323769}, "収支": {"収支": 340181}, "収入項目": {"給与A": 559642, "給与B": 104308}, "支出小項目": {"電気": 7379, "ガス": 6867, "水道": 5719, "通信": 7201, "住居": 100400, "保険": 10465, "医療": 7674, "食料品": 64419, "日用雑貨": 17642, "交通": 15378, "娯楽": 27076, "交際": 37632, "その他": 15917}, "支出大項目": {"光熱水": 19965, "通信": 7201, "住居": 100400, "医療・保険": 18139, "食料品": 64419, "日用雑貨": 17642, "交通": 15378, "娯楽": 27076, "交際": 37632}, "資産": {"資産": 19363444}}, "200302": {"収入": {"収入": 630278}, "支出": {"支出": 325980}, "収支": {"収支": 304298}, "収入項目": {"給与A": 526163, "給与B": 104115}, "支出小項目": {"電気": 6293, "ガス": 4164, "水道": 6089, "通信": 4757, "住居": 117159, "保険": 10476, "医療": 9007, "食料品": 51239, "日用雑貨": 17761, "交通": 14189, "娯楽": 28742, "交際": 41922, "その他": 14182}, "支出大項目": {"光熱水": 16546, "通信": 4757, "住居": 117159, "医療・保険": 19483, "食料品": 51239, "日用雑貨": 17761, "交通": 14189, "娯楽": 28742, "交際": 41922}, "資産": {"資産": 19667742}}, "200303": {"収入": {"収入": 710340}, "支出": {"支出": 323484}, "収支": {"収支": 386856}, "収入項目": {"給与A": 544672, "給与B": 165668}, "支出小項目": {"電気": 6594, "ガス": 6097, "水道": 6232, "通信": 6368, "住居": 115660, "保険": 10267, "医療": 9043, "食料品": 56175, "日用雑貨": 17278, "交通": 10853, "娯楽": 30078, "交際": 34690, "その他": 14149}, "支出大項目": {"光熱水": 18923, "通信": 6368, "住居": 115660, "医療・保険": 19310, "食料品": 56175, "日用雑貨": 17278, "交通": 10853, "娯楽": 30078, "交際": 34690}, "資産": {"資産": 20054598}}, "200304": {"収入": {"収入": 645767}, "支出": {"支出": 319070}, "収支": {"収支": 326697}, "収入項目": {"給与A": 534400, "給与B": 111367}, "支出小項目": {"電気": 7114, "ガス": 4154, "水道": 5831, "通信": 7874, "住居": 109016, "保険": 10682, "医療": 6593, "食料品": 52774, "日用雑貨": 15954, "交通": 14831, "娯楽": 33443, "交際": 37135, "その他": 13669}, "支出大項目": {"光熱水": 17099, "通信": 7874, "住居": 109016, "医療・保険": 17275, "食料品": 52774, "日用雑貨": 15954, "交通": 14831, "娯楽": 33443, "交際": 37135}, "資産": {"資産": 20381295}}, "200305": {"収入": {"収入": 682179}, "支出": {"支出": 341049}, "収支": {"収支": 341130}, "収入項目": {"給与A": 579299, "給与B": 102880}, "支出小項目": {"電気": 5387, "ガス": 7672, "水道": 6536, "通信": 7351, "住居": 113946, "保険": 10775, "医療": 8931, "食料品": 54363, "日用雑貨": 19048, "交通": 15102, "娯楽": 33427, "交際": 39888, "その他": 18623}, "支出大項目": {"光熱水": 19595, "通信": 7351, "住居": 113946, "医療・保険": 19706, "食料品": 54363, "日用雑貨": 19048, "交通": 15102, "娯楽": 33427, "交際": 39888}, "資産": {"資産": 20722425}}, "200306": {"収入": {"収入": 623197}, "支出": {"支出": 350710}, "収支": {"収支": 272487}, "収入項目": {"給与A": 521635, "給与B": 101562}, "支出小項目": {"電気": 6070, "ガス": 7996, "水道": 7801, "通信": 6436, "住居": 119617, "保険": 10185, "医療": 7961, "食料品": 65235, "日用雑貨": 16111, "交通": 18726, "娯楽": 23332, "交際": 42518, "その他": 18722}, "支出大項目": {"光熱水": 21867, "通信": 6436, "住居": 119617, "医療・保険": 18146, "食料品": 65235, "日用雑貨": 16111, "交通": 18726, "娯楽": 23332, "交際": 42518}, "資産": {"資産": 20994912}}, "200307": {"収入": {"収入": 689002}, "支出": {"支出": 331636}, "収支": {"収支": 357366}, "収入項目": {"給与A": 579727, "給与B": 109275}, "支出小項目": {"電気": 5339, "ガス": 7197, "水道": 5208, "通信": 5847, "住居": 113246, "保険": 10864, "医療": 9448, "食料品": 64941, "日用雑貨": 16697, "交通": 15191, "娯楽": 22138, "交際": 43188, "その他": 12332}, "支出大項目": {"光熱水": 17744, "通信": 5847, "住居": 113246, "医療・保険": 20312, "食料品": 64941, "日用雑貨": 16697, "交通": 15191, "娯楽": 22138, "交際": 43188}, "資産": {"資産": 21352278}}, "200308": {"収入": {"収入": 651379}, "支出": {"支出": 323615}, "収支": {"収支": 327764}, "収入項目": {"給与A": 527761, "給与B": 123618}, "支出小項目": {"電気": 4068, "ガス": 5242, "水道": 5382, "通信": 5726, "住居": 119254, "保険": 10120, "医療": 9486, "食料品": 51332, "日用雑貨": 18055, "交通": 11904, "娯楽": 28547, "交際": 39125, "その他": 15374}, "支出大項目": {"光熱水": 14692, "通信": 5726, "住居": 119254, "医療・保険": 19606, "食料品": 51332, "日用雑貨": 18055, "交通": 11904, "娯楽": 28547, "交際": 39125}, "資産": {"資産": 21680042}}, "200309": {"収入": {"収入": 718123}, "支出": {"支出": 329762}, "収支": {"収支": 388361}, "収入項目": {"給与A": 590786, "給与B": 127337}, "支出小項目": {"電気": 6515, "ガス": 5518, "水道": 4120, "通信": 6353, "住居": 108433, "保険": 10074, "医療": 7971, "食料品": 60295, "日用雑貨": 13945, "交通": 10240, "娯楽": 36317, "交際": 46253, "その他": 13728}, "支出大項目": {"光熱水": 16153, "通信": 6353, "住居": 108433, "医療・保険": 18045, "食料品": 60295, "日用雑貨": 13945, "交通": 10240, "娯楽": 36317, "交際": 46253}, "資産": {"資産": 22068403}}, "200310": {"収入": {"収入": 697573}, "支出": {"支出": 323292}, "収支": {"収支": 374281}, "収入項目": {"給与A": 522062, "給与B": 175511}, "支出小項目": {"電気": 7649, "ガス": 7590, "水道": 7818, "通信": 4078, "住居": 105804, "保険": 10187, "医療": 5198, "食料品": 68801, "日用雑貨": 18600, "交通": 11048, "娯楽": 30249, "交際": 34620, "その他": 11650}, "支出大項目": {"光熱水": 23057, "通信": 4078, "住居": 105804, "医療・保険": 15385, "食料品": 68801, "日用雑貨": 18600, "交通": 11048, "娯楽": 30249, "交際": 34620}, "資産": {"資産": 22442684}}, "200311": {"収入": {"収入": 732034}, "支出": {"支出": 334894}, "収支": {"収支": 397140}, "収入項目": {"給与A": 564144, "給与B": 167890}, "支出小項目": {"電気": 6115, "ガス": 7527, "水道": 5615, "通信": 6339, "住居": 116947, "保険": 10902, "医療": 9727, "食料品": 55982, "日用雑貨": 15525, "交通": 13719, "娯楽": 30881, "交際": 37118, "その他": 18497}, "支出大項目": {"光熱水": 19257, "通信": 6339, "住居": 116947, "医療・保険": 20629, "食料品": 55982, "日用雑貨": 15525, "交通": 13719, "娯楽": 30881, "交際": 37118}, "資産": {"資産": 22839824}}, "200312": {"収入": {"収入": 658828}, "支出": {"支出": 335763}, "収支": {"収支": 323065}, "収入項目": {"給与A": 516708, "給与B": 142120}, "支出小項目": {"電気": 7233, "ガス": 7731, "水道": 5941, "通信": 6100, "住居": 101102, "保険": 10232, "医療": 7641, "食料品": 65274, "日用雑貨": 13053, "交通": 14932, "娯楽": 36498, "交際": 43238, "その他": 16788}, "支出大項目": {"光熱水": 20905, "通信": 6100, "住居": 101102, "医療・保険": 17873, "食料品": 65274, "日用雑貨": 13053, "交通": 14932, "娯楽": 36498, "交際": 43238}, "資産": {"資産": 23162889}}, "200401": {"収入": {"収入": 738022}, "支出": {"支出": 321242}, "収支": {"収支": 416780}, "収入項目": {"給与A": 599610, "給与B": 138412}, "支出小項目": {"電気": 6348, "ガス": 4158, "水道": 5626, "通信": 7332, "住居": 103961, "保険": 10056, "医療": 6614, "食料品": 62048, "日用雑貨": 11512, "交通": 16093, "娯楽": 29043, "交際": 38711, "その他": 19740}, "支出大項目": {"光熱水": 16132, "通信": 7332, "住居": 103961, "医療・保険": 16670, "食料品": 62048, "日用雑貨": 11512, "交通": 16093, "娯楽": 29043, "交際": 38711}, "資産": {"資産": 23579669}}, "200402": {"収入": {"収入": 716930}, "支出": {"支出": 320476}, "収支": {"収支": 396454}, "収入項目": {"給与A": 526032, "給与B": 190898}, "支出小項目": {"電気": 5095, "ガス": 6555, "水道": 6932, "通信": 6493, "住居": 108631, "保険": 10926, "医療": 5329, "食料品": 69700, "日用雑貨": 15236, "交通": 10557, "娯楽": 28849, "交際": 34084, "その他": 12089}, "支出大項目": {"光熱水": 18582, "通信": 6493, "住居": 108631, "医療・保険": 16255, "食料品": 69700, "日用雑貨": 15236, "交通": 10557, "娯楽": 28849, "交際": 34084}, "資産": {"資産": 23976123}}, "200403": {"収入": {"収入": 672781}, "支出": {"支出": 328542}, "収支": {"収支": 344239}, "収入項目": {"給与A": 538605, "給与B": 134176}, "支出小項目": {"電気": 4879, "ガス": 4841, "水道": 4429, "通信": 7017, "住居": 108489, "保険": 10064, "医療": 5638, "食料品": 67402, "日用雑貨": 16908, "交通": 17470, "娯楽": 35908, "交際": 35045, "その他": 10452}, "支出大項目": {"光熱水": 14149, "通信": 7017, "住居": 108489, "医療・保険": 15702, "食料品": 67402, "日用雑貨": 16908, "交通": 17470, "娯楽": 35908, "交際": 35045}, "資産": {"資産": 24320362}}}, [["電気", 6051], ["ガス", 6029], ["水道", 6047], ["通信", 6122], ["住居", 110136], ["保険", 10414], ["医療", 7319], ["食料品", 58983], ["日用雑貨", 15025], ["交通", 13906], ["娯楽", 28746], ["交際", 40384], ["その他", 14963]]]
    dataYearSample = {"2001": {"収入": {"収入": 8415265}, "支出": {"支出": 3880343}, "収支": {"収支": 4534922}, "収入項目": {"給与A": 6560269, "給与B": 1854996}, "支出小項目": {"電気": 77451, "ガス": 71935, "水道": 76579, "通信": 75245, "住居": 1322999, "保険": 125867, "医療": 86460, "食料品": 685338, "日用雑貨": 170683, "交通": 167556, "娯楽": 344194, "交際": 501758, "その他": 174278}, "支出大項目": {"光熱水": 225965, "通信": 75245, "住居": 1322999, "医療・保険": 212327, "食料品": 685338, "日用雑貨": 170683, "交通": 167556, "娯楽": 344194, "交際": 501758}, "資産": {"資産": 161647851}}, "2002": {"収入": {"収入": 8347995}, "支出": {"支出": 3828319}, "収支": {"収支": 4519676}, "収入項目": {"給与A": 6457224, "給与B": 1890771}, "支出小項目": {"電気": 68596, "ガス": 68929, "水道": 69882, "通信": 68224, "住居": 1313481, "保険": 123990, "医療": 86489, "食料品": 699935, "日用雑貨": 179588, "交通": 163270, "娯楽": 322037, "交際": 481152, "その他": 182746}, "支出大項目": {"光熱水": 207407, "通信": 68224, "住居": 1313481, "医療・保険": 210479, "食料品": 699935, "日用雑貨": 179588, "交通": 163270, "娯楽": 322037, "交際": 481152}, "資産": {"資産": 216538374}}, "2003": {"収入": {"収入": 8225815}, "支出": {"支出": 3960051}, "収支": {"収支": 4265764}, "収入項目": {"給与A": 6600769, "給与B": 1625046}, "支出小項目": {"電気": 71812, "ガス": 76181, "水道": 71239, "通信": 76946, "住居": 1328446, "保険": 125067, "医療": 90537, "食料品": 738147, "日用雑貨": 190644, "交通": 169813, "娯楽": 368632, "交際": 470923, "その他": 181664}, "支出大項目": {"光熱水": 219232, "通信": 76946, "住居": 1328446, "医療・保険": 215604, "食料品": 738147, "日用雑貨": 190644, "交通": 169813, "娯楽": 368632, "交際": 470923}, "資産": {"資産": 267520906}}}
    monthSample = ["200104", "200105", "200106", "200107", "200108", "200109", "200110", "200111", "200112", "200201", "200202", "200203", "200204", "200205", "200206", "200207", "200208", "200209", "200210", "200211", "200212", "200301", "200302", "200303", "200304", "200305", "200306", "200307", "200308", "200309", "200310", "200311", "200312", "200401", "200402", "200403"]
    yearSample = ["2001", "2002", "2003"]
    function makeTableMonth(id, month, items){
        fetch('/get_dataMonth_ave')
        .then(function(response) {
            if (url.indexOf('github') >= 0){
                return dataMonthAve_sample
            } else {
                return response.json();
            }
        })
        .then(function(dataMonth_ave) {
       $(id).empty()
       dataMonth = dataMonth_ave[0]
       dataMonthAverage = dataMonth_ave[1]
      var txt = '<table class="table table-striped table-sm table-hover">'
      txt += '<thead><tr align="right">'
      txt += '<th>' + '項目' + '</th>'
      txt += '<th>' + '金額' + '</th>'
      if (items[0] == "支出小項目"){
        txt += '<th>' + '平均' + '</th>'
        txt += '<th>' + '差額' + '</th>'
      }
      txt += '</tr></thead>'
      txt += '<tbody>'
      for (item of items){
        for (var i = 0; i < Object.keys(dataMonth[month][item]).length; i++){
          txt += '<tr align="right">'
          txt += '<td>' + Object.keys(dataMonth[month][item])[i] + '</td>'
          x = Object.values(dataMonth[month][item])[i]
          txt += '<td>' +  String(x).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + '</td>'
          if (items[0] == "支出小項目"){
            x2 = dataMonthAverage[i][1]
            txt += '<td>' +  String(x2).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + '</td>'
            x3 = x - x2
            if (x3 > 0){
                txt += '<td><font color = "red">+' + String(x3).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + '</font></td>'
            } else {
                txt += '<td><font color = "blue">' + String(x3).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + '</font></td>'
            }
          }
          txt += '</tr>'
        }
      }
      txt += '</tbody>'
      txt += '</table>'
      $(id).append(txt)
        })
    }

    function makeTableYear(id, month, items){
        fetch('/get_dataYear')
        .then(function(response) {
            if (url.indexOf('github') >= 0){
                return dataYearSample
            } else {
                return response.json();
            }
        })
        .then(function(dataYear) {
        $(id).empty()
        var txt = '<table class="table table-striped table-sm table-hover">'
        txt += '<thead><tr align="right">'
        txt += '<th>' + '項目' + '</th>'
        txt += '<th>' + '金額' + '</th>'
        txt += '</tr></thead>'
        txt += '<tbody>'
        for (item of items){
            for (var i = 0; i < Object.keys(dataYear[month][item]).length; i++){
            txt += '<tr align="right">'
            txt += '<td>' + Object.keys(dataYear[month][item])[i] + '</td>'
            x = Object.values(dataYear[month][item])[i]
            txt += '<td>' +  String(x).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') + '</td>'
            txt += '</tr>'
            }
        }
        txt += '</tbody>'
        txt += '</table>'
        $(id).append(txt)})
    }

    function outConfig(x , y){
      var colors = [
        'rgb(  0,   0, 255)',
        'rgb(  0, 203, 255)',
        'rgb(255, 255,   0)',
        'rgb(216, 255, 204)',
        'rgb(  0, 255,   0)',
        'rgb(  0, 101,   0)',
        'rgb(255, 63,    0)',
        'rgb( 203,  0, 203)',
        'rgb(  0,   0,  50)'
      ]
      col = []
      for (i = 0; i< y.length; i++){
        col[i] = colors[i % colors.length]
      }
      var config = {
        type: 'pie',
        data: {
          datasets: [{
            data: y,
            backgroundColor: colors,
            label: 'Dataset 1'
          }],
          labels: x
        },
        options: {
          responsive: true
        }
      };
      return config
    }

    function update(initFlag){

      slct = $('input[name=radio]:checked').val()

      if(initFlag == false){
        window.myPie1.destroy()
        window.myPie2.destroy()
      }

      // 収入
      if(slct == "月"){
        fetch('/get_dataMonth')
        .then(function(response) {
            if (url.indexOf('github') >= 0){
                return dataMonthAve_sample[0]
            } else {
                return response.json();
            }
        })
        .then(function(dataMonth) {
        month = $("#month option:selected").val();
        var x = Object.keys(dataMonth[month]["収入項目"])
        var y = Object.values(dataMonth[month]["収入項目"])
        config = outConfig(x, y)
        var ctx = document.getElementById('shunyu').getContext('2d');
        window.myPie1 = new Chart(ctx, config);

        // 支出
        var x = Object.keys(dataMonth[month]["支出大項目"])
        var y = Object.values(dataMonth[month]["支出大項目"])
        config = outConfig(x, y)
        var ctx = document.getElementById('sishutu').getContext('2d');
        window.myPie2 = new Chart(ctx, config);

        makeTableMonth('#tbl_summary', month, ["収入", "支出", "収支"])
        makeTableMonth('#tbl_shunyu', month, ["収入項目"])
        makeTableMonth('#tbl_sishutu', month, ["支出小項目"])})
      } else if(slct == "年"){
        fetch('/get_dataYear')
        .then(function(response) {
            if (url.indexOf('github') >= 0){
                return dataYear
            } else {
                return response.json();
            }
        })
        .then(function(dataYear) {
        year = $("#year option:selected").val();
        var x = Object.keys(dataYear[year]["収入項目"])
        var y = Object.values(dataYear[year]["収入項目"])
        config = outConfig(x, y)
        var ctx = document.getElementById('shunyu').getContext('2d');
        window.myPie1 = new Chart(ctx, config);

        // 支出
        var x = Object.keys(dataYear[year]["支出大項目"])
        var y = Object.values(dataYear[year]["支出大項目"])
        config = outConfig(x, y)
        var ctx = document.getElementById('sishutu').getContext('2d');
        window.myPie2 = new Chart(ctx, config);

        makeTableYear('#tbl_summary', year, ["収入", "支出", "収支"])
        makeTableYear('#tbl_shunyu', year, ["収入項目"])
        makeTableYear('#tbl_sishutu', year, ["支出小項目"])})
      }
    }

    // アイコンの表示
    feather.replace()

    // selectBox(期間)のリスト設定
    fetch('/get_month')
      .then(function(response) {
        return response.json();
      })
      .then(function(month) {
        var arr = month
        for(var j = arr.length - 1; j >= 0; j--){
            let op = document.createElement("option");
            op.value = arr[j];
            op.text = arr[j];
            document.getElementById("month").appendChild(op);
        }
      });
    // selectBox(期間)のリスト設定
    fetch('/get_year').then(function(response) {
      return response.json();
    }).then(function(year) {
        var arr = year
        for(var j = arr.length - 1; j >= 0; j--){
            let op = document.createElement("option");
            op.value = arr[j];
            op.text = arr[j];
            document.getElementById("year").appendChild(op);
        }
    })

    $("#month").change(function(){
      var element = document.getElementById("月");
      element.checked = true ;
      update(false)
    })
    $("#year").change(function(){
      var element = document.getElementById("年");
      element.checked = true ;
      update(false)
    })
    $('input[name="radio"]:radio').change(function(){
      update(false)
    });

    update(true)


  </script>
</body>
</html>
